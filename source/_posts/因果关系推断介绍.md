---
title: "因果关系推断介绍"
date: 2019-10-04T07:34:37+08:00
tags:
  - bayesian network
  - machine learning
  - causality infer
---

这篇文章的内容来自于 "Causal Inference with Graphical Models in R Package pcalg"，如果有时间可以直接跳转阅读原文。

如果你正在寻求尝试因果推断的结构学习算法，可以参考 PC 算法的 Python 版本：[fooSynaptic/py_pcalg](https://github.com/fooSynaptic/py_pcalg)，该仓库提供了 PC 算法的结构学习算法并且支持可视化。

## 背景

贝叶斯网络的研究从图模型、结构方程到因果推断逐步发展起来。因果推断可以等价于两个部分：

1. **变量之间的图结构学习**
2. **图结构中方向的推断**（大部分人其实不认同因果关系能够从数据中推断出来，然而在因果推断的研究中默认研究的是非时序的观测数据）

## 正文

在很多学科中，理解变量之间的因果关系都是一个非常有意义的话题。通常，实验科学通过在实验中干预特定因素来观察这种关系。但在现实生活中，存在时间、费用以及伦理等限制，往往没有办法做实验来发现这一关系。

因此，数据科学家们对于从观测数据中推断因果信息这个问题很感兴趣，也产生了非常多有意义的研究成果。通过合理的假设，类似 PC 算法可以通过观测数据来推断因果结构。

### PC 算法简介

R package pcalg 整合了多种算法，包括 PC、FCI、RFCI、GES、GIES 以及 IDA。

**示例说明：**

在因果推断的结果图中：
- **单向箭头**：代表直接的有向因果效应
- **双向箭头**：意味着算法无法判断因果效应的方向（不确定性）

一个重要的事实是：普遍来说，PC 算法无法从观测数据中得到唯一的 DAG，即便数据量很大，因为多个 DAG 可以描述相同的条件独立性信息。

### 马尔可夫等价类

为什么是"类"呢？因为多个结构可以描述相同的条件概率（贝叶斯概率）。

举个例子：
- **结构 a**：A ← C → B
- **结构 b**：A → C → B

对于 a：P(C)P(A|C)P(B|C)  
对于 b：P(A)P(C|A)P(B|C) = P(C)P(A|C)P(B|C)

所以 a 等价于 b。马尔可夫等价类在贝叶斯概率的计算上是等价的，却有着完全不同的结构。

## 研究方法背景

贝叶斯网络图模型常用于因果结构的推断。图模型可以理解为从联合概率到有依赖关系的结构的一种映射关系，就像地图一样：

1. 需要一个包含点和线符号的物理位置图
2. 需要合理的规则来对图上的符号进行解释

## DAG 模型与 D-separation

**D-separation 定义：**

如果在模型图中存在两个节点 x 和 y，它们被节点集合 S 所分隔（d-separated），那么相应的在集合 S 存在下，两个随机变量 Vx 和 Vy 条件性相互独立。

记作：Vx ⊥ Vy | S

### PC 算法伪代码

**输入：**
- 代表图模型节点的随机变量集合 V
- 条件独立性信息
- 统计检验显著性水平 α

**输出：**
- 部分完备有向无环图 CPDAG
- 分隔变量集合
- 边的方向

**步骤：**
1. 构造随机变量集合 V 的完全联通图（所有节点相连接）
2. 利用显著性水平 α 对相邻的统计变量集合进行条件独立性检验，如果存在条件性独立，就将两个变量之间的边去除
3. 确定 V 结构（确定方向）
4. 确定剩余边的方向

---

> 转载请注明出处
